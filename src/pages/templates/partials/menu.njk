{% import 'partials/user.njk' as user %}

{%
  set mainMenu = [
    { name: 'my profile', mods: 'item--icon item--icon--profile' },
    { name: 'dashboard' },
    { name: 'projects' },
    {
      name: 'contracts',
      list: [
        { name: 'active', iconMods: 'menu__link-icon--liststyle menu__link-icon--liststyle--green' },
        { name: 'pending', iconMods: 'menu__link-icon--liststyle menu__link-icon--liststyle--blue' },
        { name: 'disputes', iconMods: 'menu__link-icon--liststyle menu__link-icon--liststyle--purple' },
        { name: 'drafts', iconMods: 'menu__link-icon--liststyle menu__link-icon--liststyle--orange' },
        { name: 'closed', iconMods: 'menu__link-icon--liststyle menu__link-icon--liststyle--grey' }
      ]
    },
    { name: 'settings' }
  ]
%}

{%
  set helpList = [
    { name: 'F.A.Q.', linkMods: 'menu__link--help' },
    { name: 'Guide', linkMods: 'menu__link--help' },
    { name: 'Help', linkMods: 'menu__link--help' }
  ]
%}

{% macro makeList(items, mods, id) %}
  <ul {{ 'id=' + id if id }} class="menu__list {{ mods }} {{ 'collapse' if id }}">
    {% for item in items %}
      <li class="menu__item {{ item.mods }}">

        {% if item.list %}
          {% set newId = 'menu-list-' + item.name %}

          <a class="menu__link menu__link--toggler {{item.linkMods}}" href="#{{ newId }}" data-toggle="collapse" aria-expanded="false" aria-controls="{{ newId }}">
            <span class="menu__link-icon {{ item.iconMods }}"></span><span class="menu__link-text">{{ item.name }}</span>
          </a>

          {{ makeList(item.list, 'menu__list--level--two', newId) }}
        {% else %}
          <a class="menu__link {{'menu__link--level--two' if id}}  {{item.linkMods}}" href="{{ item.href if item.href else '#' }}">
            <span class="menu__link-icon {{ item.iconMods }}"></span><span class="menu__link-text">{{ item.name }}</span>
          </a>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% endmacro %}

<div id="menu" class="menu menu--collapsed dashboard__menu">
  <div class="menu__jot-info">
    <ul class="infographics menu__infographics">
      <li class="infographics__item">
        <span class="infographics__line infographics__line--emphasis">2</span>
        <span class="infographics__line">Projects</span>
      </li>

      <li class="infographics__item">
        <span class="infographics__line infographics__line--emphasis">5089.62</span>
        <span class="infographics__line">ETH Invested</span>
      </li>

      <li class="infographics__item">
        <span class="infographics__line infographics__line--emphasis">15.84</span>
        <span class="infographics__line">Jot balance</span>
      </li>
    </ul>

    <div class="menu__add-jot">
      <a href="#" class="button button--add-jot">Add Jot</a>
    </div>
  </div>

  <nav class="menu__side-menu">
    <div class="menu__logotype">
      <a href="#" class="logotype menu__logotype-link">
        <img class="menu__logotype-img" src="assets/imgs/logotype.png" alt="Jury.Online Logotype" width="164" height="30">
      </a>
    </div>

    <div class="menu__block menu__block--divider menu__profile">
      {{ user.modify('menu__user') }}
  
      <a class="button button--theme--empty button--add menu__add-contact" href="#">Add contact</a>
    </div>

    {{ makeList( mainMenu ) }}

    {{ makeList( helpList, 'menu__list--help' ) }}

    <div class="menu__block menu__sign-out">
      <a class="button button--theme--empty button--sign-out" href="#">Sign out</a>
    </div>
  </nav>

  <div id="menu-lining" class="menu__lining"></div>
</div>
